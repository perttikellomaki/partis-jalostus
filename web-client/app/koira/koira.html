<script type="text/ng-template" id="category_renderer">
  {{summary}}
  <a href ng-show="!expanded" ng-click="toggleExpand()">lisää...</a>
  <a href ng-show="expanded" ng-click="toggleExpand()">vähemmän...</a>
  <br>
  <span ng-show="expanded">
    <hr>
    <span ng-repeat="entry in entries">
      <span ng-show="!entry.editing">
	<span ng-include="category_name + '_details'"></span>
      </span>
      <span ng-show="entry.editing">
	<span ng-include="category_name + '_input'"></span>
      </span>
      <button ng-show="!entry.editing" ng-click="toggleEdit(entry)">Muuta</button>
      <button ng-show="entry.editing" ng-click="save(entry)">Tallenna</button>
      <span ng-show="entry.history.length > 0">
	<input type="checkbox" ng-model="entry.show_history">Historia</input>
      </span>
      <br>
      <span ng-show="entry.show_history" ng-repeat="history in entry.history">
	<span class="history" ng-include="category_name + '_history'"></span>
      </span>
      <hr>
    </span>
    <button ng-show="!entry" ng-click="newEntry()">Uusi</button>
    <span ng-include="category_name + '_input'"></span>
    <button ng-show="entry" ng-click="save(entry)">Tallenna</button>
  </span>
</script>

<script type="text/ng-template" id="paimennus_details">
  Päivä {{entry.resource.paiva}}, 
  Paikka {{entry.resource.paikka}},
  Tuomari {{entry.resource.tuomari}}
  <br>
  Kiinnostus / taipumus / henkinen kestävyys / ohjattavuus:
  {{entry.resource.kiinnostus}} / 
  {{entry.resource.taipumus}} /
  {{entry.resource.henkinen_kestavyys}} /
  {{entry.resource.ohjattavuus}}<br>
  <span class="author_nick">{{entry.resource.author_nick}}</span>
</script>

<script type="text/ng-template" id="paimennus_history">
  {{history.paiva}}, 
  {{history.paikka}},
  {{history.tuomari}}:
  {{history.kiinnostus}} / 
  {{history.taipumus}} /
  {{history.henkinen_kestavyys}} /
  {{history.ohjattavuus}}
  <span class="author_nick">{{history.author_nick}}</span>
  {{history.timestamp}}
  <br>
</script>

<script type="text/ng-template" id="paimennus_input">
  <span ng-show="entry">
    Kiinnostus <input ng-model="entry.resource.kiinnostus"/><br>
    Luontainen taipumus <input ng-model="entry.resource.taipumus"/><br>
    Henkinen kestävyys <input ng-model="entry.resource.henkinen_kestavyys"/><br>
    Ohjattavuus <input ng-model="entry.resource.ohjattavuus"/><br>
    Tuomari <input ng-model="entry.resource.tuomari"/><br>
    Paikka <input ng-model="entry.resource.paikka"/><br>
    Päivä <input ng-model="entry.resource.paiva"/><br>
  </span>
</script>

<form>
  Virallinen nimi / muu tunniste:
  <input ng-show="editing" ng-model="koira.virallinen_nimi"/>
  <span ng-show="!editing">{{koira.virallinen_nimi}}</span>
  <br>
  <span ng-show="editing">
    Isä: <select ui-select2 ng-model="koira.isa" data-placeholder="-- Isä --" style="width:200px">
      <option value=""></option>
      <option ng-repeat="item in items" value="{{item.uri}}">{{item.virallinen_nimi}}</option>
    </select>
    <br>
  Emä: <select ui-select2 ng-model="koira.ema" data-placeholder="-- Emä --" style="width:200px">
    <option value=""></option>
    <option ng-repeat="item in items" value="{{item.uri}}">{{item.virallinen_nimi}}</option>
  </select>
  </span>
  <span ng-show="!editing">Isä: {{isa.virallinen_nimi}}<br>Emä: {{ema.virallinen_nimi}}</span>
  <br>
  <span class="author_nick">{{koira.author_nick}}</span>
  <br>
  <button ng-show="editing" ng-click="save()">Tallenna</button>
  <button ng-show="!editing" ng-click="toggleEdit()">Muuta</button>
  <span ng-show="koira_history.length > 0">
    <input type="checkbox" ng-model="koira_show_history">Historia</input>
    <br>
    <span ng-show="koira_show_history" class="history" ng-repeat="h in koira_history">
      <span ng-controller="KoiraHistoryCtrl">
	{{h.virallinen_nimi}}, isä {{isa.virallinen_nimi}}, emä {{ema.virallinen_nimi}},
	({{h.author_nick}}
	{{h.timestamp}})<br>
      </span>
    </span>
  </span>
</form>
<span ng-switch="existing_koira">
  <span ng-switch-when="true">
    <form style="background: AliceBlue;" ng-controller="PaimennusCtrl">
      Paimennustaipumuskoe: 
      <span ng-include="'category_renderer'"></span>
    </form>
  </span>
</span>
